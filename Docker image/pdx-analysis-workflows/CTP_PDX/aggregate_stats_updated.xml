<tool id="Aggregate_CTP_Stats" name="Compile Aggregated Stats" version="0.0.0">
    <description>tool</description>
    <stdio>
         <exit_code range="1:" level="fatal" />
    </stdio>
    <command>
        <![CDATA[

            python '${__tool_directory__}/bin/aggregate_stats_updated.py' $out_1 ${input_type.in_1} ${input_type.in_2} ${input_type.in_3}
        ]]>
    </command>
    <inputs>
        <conditional name="input_type">
            <param name="add" type="select" label="Input Type">
                <option value="single_dataset" selected="true">Single (Sample)</option>
                <option value="sample_collection" >Collection (Multiple Samples)</option>
            </param>
            <when value="single_dataset">
                <param format="txt" name="in_1" type="data" label="Quality Stats"
                       help="This dataset is generated by Quality Statistics tool."/>
                <param format="txt" name="in_2" type="data" label="De-duplicate Metrics"
                       help="This dataset is generated by Variant Pre-processing tool."/>
                <param format="txt" name="in_3" type="data" label="Picard HsMetrics"
                       help="This dataset is generated by Variant Pre-processing tool."/>
            </when>
            <when value="sample_collection">
                <param name="in_1" format="bam" type="data_collection" collection_type="list"
                       label="Select MicroIndels DPfiltered 1 Collection"
                       help="Specify MicroIndels DPfiltered 1 dataset collection."/>
            </when>
        </conditional>
    </inputs>
    <outputs>
        <data name="out_1" format="txt" from_work_dir="summary_stats.txt" label="Summary Stats">
             <filter>input_type['add'] == 'single_dataset'</filter>
        </data>

        <collection name="list_output" type="list" label="Summary Stats Collection">
            <data name="summary_stats" format="txt" from_work_dir="summary_stats.txt" hidden="true"/>
            <filter>input_type['add'] == 'sample_collection'</filter>
        </collection>
    </outputs>

    <help>
        Compile alignment QC, duplication metrics and coverage statistics into a single file.

        This tool has following input and output dataset or collections.

        Inputs:

        1) Quality Statistics file

        2) Duplication metrics file

        3) Picard HsMetrics file

        Outputs:

        Based on the input selection, following will be output(s).

        1) Summary statistics file

    </help>
</tool>
